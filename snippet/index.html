<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leo's Studio | Bedrock snippets</title>
    <meta name="description" content="A curated collection of Minecraft Bedrock snippets, Entity behaviors, and Molang examples.">
    <meta name="theme-color" content="#3c8527">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;700&display=swap');
        :root { --bg-base: #1e1e1e; --bg-panel: #2b2b2b; --border-light: #3c3c3c; --border-dark: #161616; --mc-green: #3c8527; --mc-green-hover: #2a641c; --text-main: #e0e0e0; }
        body { background-color: var(--bg-base); color: var(--text-main); font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .ore-panel { background-color: #3b3b3b; border: 2px solid; border-color: #5b5b5b #1e1e1e #1e1e1e #5b5b5b; box-shadow: inset 0 0 0 2px #2b2b2b; }
        .ore-panel.featured-gold { border-color: #fbbf24 #78350f #78350f #fbbf24; box-shadow: inset 0 0 0 2px #451a03, 0 0 15px rgba(251, 191, 36, 0.1); }
        .ore-input { background-color: #1e1e1e; border: 2px solid; border-color: #161616 #5b5b5b #5b5b5b #161616; color: white; outline: none; }
        .ore-input:focus { border-color: #5b5b5b #a0a0a0 #a0a0a0 #5b5b5b; }
        .ore-btn { background-color: #3b3b3b; border: 2px solid; border-color: #5b5b5b #1e1e1e #1e1e1e #5b5b5b; color: #e0e0e0; cursor: pointer; text-shadow: 1px 1px 0 #1e1e1e; display: inline-flex; justify-content: center; align-items: center; transition: all 0.1s; }
        .ore-btn:hover { background-color: #4a4a4a; color: #ffffff; }
        .ore-btn:active { border-color: #1e1e1e #5b5b5b #5b5b5b #1e1e1e; background-color: #2b2b2b; transform: translateY(1px); }
        .ore-btn-green { background-color: var(--mc-green); border-color: #5cb345 #1e4513 #1e4513 #5cb345; }
        .ore-btn-green:hover { background-color: var(--mc-green-hover); }
        .ore-btn-discord { background-color: #5865F2; border-color: #7983f5 #3f48ad #3f48ad #7983f5; color: white; }
        .ore-btn-discord:hover { background-color: #4752c4; }
        .cat-btn.active { background-color: var(--mc-green); border-color: #5cb345 #1e4513 #1e4513 #5cb345; color: white; }
        ::-webkit-scrollbar { width: 12px; }
        ::-webkit-scrollbar-track { background: #1e1e1e; }
        ::-webkit-scrollbar-thumb { background: #4a4a4a; border: 2px solid #1e1e1e; }
        .hidden { display: none !important; }
        .loading-spinner { border: 4px solid #3c3c3c; border-top: 4px solid #3c8527; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .text-clamp-1 { display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; word-break: break-all; }
        .text-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .code-preview-box { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; line-height: 1.4; color: #a0a0a0; background-color: #161616; border: 2px solid #1e1e1e; padding: 0.75rem; overflow: hidden; white-space: pre-wrap; word-break: break-all; max-height: 140px; position: relative; cursor: pointer; transition: border-color 0.2s; }
        .code-preview-box:hover { border-color: #5b5b5b; }
        .code-fade-overlay { position: absolute; bottom: 0; left: 0; right: 0; height: 40px; background: linear-gradient(to bottom, transparent, #262626); pointer-events: none; z-index: 10; }
        .expand-overlay { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background-color: rgba(0,0,0,0.7); backdrop-filter: blur(2px); opacity: 0; transition: opacity 0.2s ease; z-index: 20; }
        .group:hover .expand-overlay { opacity: 1; }
        .modal-enter { animation: modalFadeIn 0.2s ease-out forwards; }
        @keyframes modalFadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <div id="loginOverlay" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90 backdrop-blur-sm">
        <div class="ore-panel p-8 w-96 text-center shadow-2xl relative modal-enter">
            <h1 class="text-2xl font-bold mb-1 text-white uppercase tracking-wider">Leo's Studio</h1>
            <p class="text-sm text-gray-400 mb-6">Bedrock snippets</p>
            <div id="loginForm" class="space-y-4">
                <input type="text" id="usernameInput" placeholder="Username" class="ore-input w-full p-3">
                <input type="password" id="passwordInput" placeholder="Password" class="ore-input w-full p-3">
                <div class="flex gap-2 pt-2">
                    <button onclick="_0x5e2()" id="loginBtn" class="ore-btn ore-btn-green w-full py-2 font-bold">Login / Sign Up</button>
                </div>
                <p class="text-xs text-gray-500 mt-2">If account doesn't exist, it will be created.</p>
            </div>
            <div id="loginLoader" class="hidden flex-col items-center py-4">
                <div class="loading-spinner w-8 h-8 border-2 mb-2"></div>
                <p class="text-xs text-gray-400">Verifying credentials...</p>
            </div>
            <p id="authError" class="text-red-400 text-xs mt-4 h-4"></p>
        </div>
    </div>
    <header class="bg-[#2b2b2b] border-b-2 border-[#161616] sticky top-0 z-40 shadow-lg">
        <div class="container mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="h-10 w-10 bg-[#3c3c3c] border-2 border-[#5b5b5b] flex items-center justify-center text-xl font-bold text-green-500">L</div>
                <div>
                    <h1 class="font-bold text-lg leading-none tracking-wide text-white">LEO'S STUDIO</h1>
                    <span class="text-xs text-[#a0a0a0] uppercase tracking-wider">Bedrock Scripting</span>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <div id="adminBadge" class="hidden px-3 py-1 bg-red-900 border border-red-500 text-red-200 text-xs font-bold uppercase rounded-sm">Admin</div>
                <div class="flex items-center gap-3 bg-[#1e1e1e] px-4 py-1.5 border border-[#3c3c3c]">
                    <i class="fas fa-user text-gray-400"></i>
                    <span id="displayUsername" class="font-mono text-sm text-white">Guest</span>
                </div>
                <button onclick="_0x9a1()" class="ore-btn px-3 py-1 text-xs">LOGOUT</button>
            </div>
        </div>
    </header>
    <main class="flex-grow container mx-auto px-4 py-8">
        <div class="flex flex-col md:flex-row gap-4 mb-4">
            <div class="flex-grow relative">
                <input type="text" id="searchInput" onkeyup="_0x7c4()" placeholder="Search snippets..." class="ore-input w-full p-4 pl-12 text-lg shadow-inner">
                <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500"></i>
            </div>
            <div class="flex gap-2 flex-wrap sm:flex-nowrap">
                <button id="adminImportBtn" onclick="_0x8d3()" class="hidden ore-btn bg-red-900 border-red-800 text-red-100 px-6 flex items-center gap-2 font-bold shadow-md whitespace-nowrap">
                    <i class="fas fa-file-import"></i> IMPORT
                </button>
                <a href="https://discord.gg/4R8jrRsXZb" target="_blank" class="ore-btn ore-btn-discord px-6 flex items-center gap-2 font-bold shadow-md whitespace-nowrap text-decoration-none">
                    <i class="fab fa-discord"></i> JOIN DISCORD
                </a>
                <button onclick="_0x6f5()" class="ore-btn ore-btn-green px-6 flex items-center gap-2 font-bold shadow-md whitespace-nowrap">
                    <i class="fas fa-plus"></i> NEW SNIPPET
                </button>
            </div>
        </div>
        <div class="flex gap-2 mb-8 overflow-x-auto pb-2" id="categoryBar">
            <button onclick="_0x3e1('All')" class="ore-btn cat-btn active px-4 py-1 text-sm rounded-full whitespace-nowrap">All</button>
            <button onclick="_0x3e1('Entity Behavior')" class="ore-btn cat-btn px-4 py-1 text-sm rounded-full whitespace-nowrap">Entity Behavior</button>
            <button onclick="_0x3e1('Script API')" class="ore-btn cat-btn px-4 py-1 text-sm rounded-full whitespace-nowrap">Script API</button>
            <button onclick="_0x3e1('Molang')" class="ore-btn cat-btn px-4 py-1 text-sm rounded-full whitespace-nowrap">Molang</button>
            <button onclick="_0x3e1('Items')" class="ore-btn cat-btn px-4 py-1 text-sm rounded-full whitespace-nowrap">Items</button>
            <button onclick="_0x3e1('Blocks')" class="ore-btn cat-btn px-4 py-1 text-sm rounded-full whitespace-nowrap">Blocks</button>
            <button onclick="_0x3e1('Recipes')" class="ore-btn cat-btn px-4 py-1 text-sm rounded-full whitespace-nowrap">Recipes</button>
            <button onclick="_0x3e1('UI/Forms')" class="ore-btn cat-btn px-4 py-1 text-sm rounded-full whitespace-nowrap">UI/Forms</button>
            <button onclick="_0x3e1('Commands')" class="ore-btn cat-btn px-4 py-1 text-sm rounded-full whitespace-nowrap">Commands</button>
            <button onclick="_0x3e1('JSON UI')" class="ore-btn cat-btn px-4 py-1 text-sm rounded-full whitespace-nowrap">JSON UI</button>
        </div>
        <div id="loadingState" class="hidden flex flex-col items-center justify-center py-12">
            <div class="loading-spinner mb-4"></div>
            <p class="text-gray-400">Syncing with cloud database...</p>
        </div>
        <div id="snippetGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        <div id="emptyState" class="hidden text-center py-20 opacity-50">
            <i class="fas fa-box-open text-6xl mb-4 text-gray-600"></i>
            <h2 class="text-xl font-bold">No snippets found</h2>
            <p>Try a different category or search term.</p>
        </div>
    </main>
    <div id="alertModal" class="fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-80 backdrop-blur-sm hidden">
        <div class="ore-panel w-96 p-0 shadow-2xl flex flex-col modal-enter">
            <div class="p-3 border-b-2 border-[#1e1e1e] bg-[#2b2b2b] flex justify-between items-center">
                <h3 id="alertTitle" class="font-bold text-white text-sm">System Message</h3>
                <button onclick="_0x2b9()" class="text-gray-400 hover:text-white"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-6 text-center">
                <p id="alertMessage" class="text-gray-300 text-sm mb-6">Message goes here...</p>
                <div class="flex justify-center gap-2" id="alertActions">
                </div>
            </div>
        </div>
    </div>
    <div id="uploadModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 backdrop-blur-sm hidden">
        <div class="ore-panel w-full max-w-2xl p-0 shadow-2xl flex flex-col max-h-[90vh] modal-enter">
            <div class="p-3 border-b-2 border-[#1e1e1e] bg-[#2b2b2b] flex justify-between items-center">
                <h3 class="font-bold text-white pl-2">Submit Snippet</h3>
                <button onclick="_0x4a7()" class="ore-btn w-8 h-8 text-red-400 hover:text-red-200"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-6 overflow-y-auto space-y-4">
                <div>
                    <label class="block text-xs uppercase text-gray-400 mb-1">Snippet Title</label>
                    <input type="text" id="snipTitle" class="ore-input w-full p-2" placeholder="e.g., Exploding Cow">
                </div>
                <div>
                    <label class="block text-xs uppercase text-gray-400 mb-1">Description</label>
                    <textarea id="snipDesc" rows="3" class="ore-input w-full p-2 text-sm" placeholder="What does this code do?"></textarea>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs uppercase text-gray-400 mb-1">Category</label>
                        <select id="snipCategory" class="ore-input w-full p-2">
                            <option value="Entity Behavior">Entity Behavior</option>
                            <option value="Script API">Script API (JS)</option>
                            <option value="Molang">Molang</option>
                            <option value="Items">Items</option>
                            <option value="Blocks">Blocks</option>
                            <option value="Recipes">Recipes</option>
                            <option value="UI/Forms">UI/Forms</option>
                            <option value="Commands">Commands</option>
                            <option value="JSON UI">JSON UI</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-xs uppercase text-gray-400 mb-1">Version</label>
                        <input type="text" id="snipVersion" class="ore-input w-full p-2" placeholder="e.g., 1.20.50">
                    </div>
                </div>
                <div>
                    <label class="block text-xs uppercase text-gray-400 mb-1">Code (JSON or JS)</label>
                    <textarea id="snipCode" rows="6" class="ore-input w-full p-3 font-mono text-sm leading-relaxed" placeholder='{ "format_version": "1.20.50", ... }'></textarea>
                </div>
                <div class="bg-[#2b2b2b] p-3 border border-[#3c3c3c]">
                    <label class="block text-xs uppercase text-green-500 font-bold mb-1" id="captchaLabel">Security Check</label>
                    <input type="number" id="captchaInput" class="ore-input w-full p-2" placeholder="Enter the result...">
                </div>
            </div>
            <div class="p-4 border-t-2 border-[#1e1e1e] bg-[#2b2b2b] flex justify-end gap-3">
                <button onclick="_0x4a7()" class="ore-btn px-6 py-2">Cancel</button>
                <button onclick="_0x5c8()" class="ore-btn ore-btn-green px-6 py-2 font-bold">Submit for Review</button>
            </div>
        </div>
    </div>
    <div id="viewModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90 backdrop-blur-sm hidden">
        <div class="ore-panel w-full max-w-4xl p-0 shadow-2xl flex flex-col h-[85vh] modal-enter">
            <div class="p-3 border-b-2 border-[#1e1e1e] bg-[#2b2b2b] flex justify-between items-center">
                <h3 id="viewTitle" class="font-bold text-white text-xl truncate pr-4 pl-2">Snippet Title</h3>
                <button onclick="_0x1d9()" class="ore-btn w-8 h-8 text-red-400 hover:text-red-200"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-6 overflow-y-auto flex-grow bg-[#222]">
                <div class="flex gap-2 mb-4">
                    <span id="viewCategory" class="text-xs bg-[#1e1e1e] px-2 py-1 text-blue-300 border border-[#3c3c3c]">Category</span>
                    <span id="viewVersion" class="text-xs bg-[#1e1e1e] px-2 py-1 text-yellow-600 border border-[#3c3c3c]">Version</span>
                </div>
                <div class="mb-6 p-4 bg-[#2b2b2b] border border-[#3c3c3c] rounded text-gray-300">
                    <h4 class="text-xs uppercase text-gray-500 font-bold mb-2">Description</h4>
                    <p id="viewDesc" class="text-sm leading-relaxed whitespace-pre-wrap">No description.</p>
                </div>
                <div class="relative group">
                    <textarea id="viewCode" readonly class="w-full h-[400px] bg-[#161616] text-[#a0a0a0] p-4 font-mono text-sm resize-none focus:outline-none border-2 border-[#1e1e1e] rounded"></textarea>
                    <button onclick="_0x0f2(this)" class="absolute top-4 right-4 ore-btn text-xs py-1 px-3">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div id="adminModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 backdrop-blur-sm hidden">
        <div class="ore-panel w-full max-w-2xl p-0 shadow-2xl flex flex-col max-h-[90vh] modal-enter">
            <div class="p-3 border-b-2 border-[#1e1e1e] bg-[#8f2121] flex justify-between items-center">
                <h3 class="font-bold text-white pl-2">Admin Import</h3>
                <button onclick="_0x9c4()" class="ore-btn w-8 h-8 text-white hover:text-gray-200"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-6">
                <p class="text-xs text-gray-400 mb-2">Paste raw JSON from Discord.</p>
                <textarea id="adminJsonPaste" rows="12" class="ore-input w-full p-3 font-mono text-xs" placeholder='{"id": ...}'></textarea>
            </div>
            <div class="p-4 border-t-2 border-[#1e1e1e] bg-[#2b2b2b] flex justify-end gap-3">
                <button onclick="_0x9c4()" class="ore-btn px-6 py-2">Cancel</button>
                <button onclick="_0x7b6()" class="ore-btn ore-btn-green px-6 py-2 font-bold">Publish</button>
            </div>
        </div>
    </div>
    <script>
        const _k1 = ["6", "9", "4", "9", "8", "d", "3", "7", "d", "0", "e", "a", "8", "8", "1", "f", "4", "0", "3", "a", "2", "e", "8", "6"];
        const _k2 = ["$", "2", "a", "$", "1", "0", "$", "S", "5", "u", "p", "b", "Y", "7", "4", "r", "Q", "f", "t", "m", "i", "U", "R", ".", "7", "W", "O", "g", "O", "r", "H", "V", "j", "a", "C", "A", "I", "o", "Q", "d", "B", "Y", "y", "b", "m", "L", "5", "l", "V", "H", "I", "H", "E", "9", "z", "W", "s", "C", "N", "m"];
        const _k3 = ["h", "t", "t", "p", "s", ":", "/", "/", "d", "i", "s", "c", "o", "r", "d", ".", "c", "o", "m", "/", "a", "p", "i", "/", "w", "e", "b", "h", "o", "o", "k", "s", "/", "1", "4", "5", "2", "7", "3", "1", "5", "9", "0", "7", "2", "2", "5", "8", "4", "7", "4", "7", "/", "p", "r", "f", "X", "v", "F", "d", "2", "R", "h", "4", "o", "v", "y", "V", "Y", "L", "G", "s", "9", "S", "H", "S", "b", "A", "Y", "V", "k", "B", "k", "c", "-", "k", "U", "n", "r", "B", "0", "4", "z", "O", "c", "x", "2", "X", "q", "v", "D", "v", "i", "s", "r", "S", "1", "o", "E", "z", "J", "z", "x", "i", "p", "-", "K", "w", "_", "I", "C"];
        const _k4 = "ExterLeo";
        
        const _x_bin = _k1.join('');
        const _x_mas = _k2.join('');
        const _x_dis = _k3.join('');
        const _x_adm = _k4;
        
        let _u = null;
        let _d = { users: [], snippets: [] }; 
        let _c = 'All';
        let _v = {};
        let _z = 0; 

        document.addEventListener('DOMContentLoaded', () => {
            const _ls = localStorage.getItem('ls_user');
            if (_ls) {
                _u = _ls;
                const _lv = localStorage.getItem('ls_user_votes');
                if(_lv) _v = JSON.parse(_lv);
                document.getElementById('loginOverlay').classList.add('hidden');
                _0x1a4(true); 
            }
        });

        function _0x3b2(m, t = "System Message") {
            document.getElementById('alertTitle').innerText = t;
            document.getElementById('alertMessage').innerText = m;
            const a = document.getElementById('alertActions');
            a.innerHTML = `<button onclick="_0x2b9()" class="ore-btn px-6 py-2">OK</button>`;
            document.getElementById('alertModal').classList.remove('hidden');
        }

        function _0x8c1(m, c) {
            document.getElementById('alertTitle').innerText = "Confirmation";
            document.getElementById('alertMessage').innerText = m;
            const a = document.getElementById('alertActions');
            a.innerHTML = ``; 
            const b1 = document.createElement('button');
            b1.className = "ore-btn px-4 py-2 mr-2";
            b1.innerText = "Cancel";
            b1.onclick = _0x2b9;
            const b2 = document.createElement('button');
            b2.className = "ore-btn ore-btn-green px-4 py-2 font-bold";
            b2.innerText = "Confirm";
            b2.onclick = () => { _0x2b9(); c(); };
            a.appendChild(b1);
            a.appendChild(b2);
            document.getElementById('alertModal').classList.remove('hidden');
        }

        function _0x2b9() {
            document.getElementById('alertModal').classList.add('hidden');
        }

        async function _0x5e2() {
            const u = document.getElementById('usernameInput').value.trim();
            const p = document.getElementById('passwordInput').value.trim();
            const e = document.getElementById('authError');
            const l = document.getElementById('loginLoader');
            const f = document.getElementById('loginForm');
            if (!u || !p) { e.textContent = "Please enter credentials."; return; }
            f.classList.add('hidden');
            l.classList.remove('hidden');
            e.textContent = "";
            try {
                await _0x9f1();
                const x = _d.users.find(k => k.username.toLowerCase() === u.toLowerCase());
                if (x) {
                    if (x.password === p) {
                        _0x2d1(x.username);
                    } else {
                        throw new Error("Incorrect password.");
                    }
                } else {
                    if (!_x_mas) {
                        throw new Error("Database Write Key missing in code.");
                    }
                    const n = { 
                        username: u, 
                        password: p, 
                        joined: new Date().toISOString() 
                    };
                    _d.users.push(n);
                    await _0x4e3();
                    _0x2d1(u);
                }
            } catch (err) {
                console.error(err);
                e.textContent = err.message || "Connection Error.";
                f.classList.remove('hidden');
                l.classList.add('hidden');
            }
        }

        function _0x2d1(u) {
            _u = u;
            localStorage.setItem('ls_user', u);
            document.getElementById('loginOverlay').classList.add('hidden');
            _0x1a4();
        }

        function _0x9a1() {
            localStorage.removeItem('ls_user');
            location.reload();
        }

        async function _0x1a4(r = false) {
            document.getElementById('displayUsername').textContent = _u;
            if (_u === _x_adm) {
                document.getElementById('adminBadge').classList.remove('hidden');
                document.getElementById('adminImportBtn').classList.remove('hidden');
            }
            if (!r) {
                _0x6b2();
            } else {
                _0x2a9();
            }
        }

        async function _0x9f1() {
            try {
                const r = await fetch(`https://api.jsonbin.io/v3/b/${_x_bin}/latest`, {
                    headers: _x_mas ? { 'X-Master-Key': _x_mas } : {}
                });
                if(!r.ok) throw new Error("Status: " + r.status);
                const j = await r.json();
                if (Array.isArray(j.record)) {
                    _d = { users: [], snippets: j.record };
                } else {
                    _d = j.record || { users: [], snippets: [] };
                }
                return _d;
            } catch (e) {
                throw new Error("Database Connection Failed: " + e.message);
            }
        }

        async function _0x4e3() {
            if (!_x_mas) throw new Error("Missing API Key");
            await fetch(`https://api.jsonbin.io/v3/b/${_x_bin}`, {
                method: 'PUT',
                headers: { 
                    'Content-Type': 'application/json',
                    'X-Master-Key': _x_mas
                },
                body: JSON.stringify(_d)
            });
        }

        async function _0x2a9() {
            const g = document.getElementById('snippetGrid');
            const l = document.getElementById('loadingState');
            g.innerHTML = '';
            l.classList.remove('hidden');
            try {
                await _0x9f1();
                _0x6b2();
            } catch (e) {
                l.classList.add('hidden');
                g.innerHTML = `
                    <div class="col-span-1 md:col-span-3 text-center p-8 bg-[#3b2222] border border-red-800 rounded">
                        <i class="fas fa-exclamation-triangle text-4xl text-red-500 mb-4"></i>
                        <h3 class="text-xl font-bold text-white">Database Error</h3>
                        <p class="text-red-300 mt-2">${e.message}</p>
                        <p class="text-gray-400 text-sm mt-4">Please try refreshing the page later.</p>
                    </div>
                `;
            } finally {
                l.classList.add('hidden');
            }
        }

        function _0x3e1(c) {
            _c = c;
            document.querySelectorAll('.cat-btn').forEach(b => {
                if(b.innerText === c) b.classList.add('active');
                else b.classList.remove('active');
            });
            _0x6b2(document.getElementById('searchInput').value);
        }

        function _0x6b2(q = '') {
            const g = document.getElementById('snippetGrid');
            g.innerHTML = '';
            const f = _d.snippets.filter(s => {
                const m = s.title.toLowerCase().includes(q.toLowerCase()) || 
                          (s.description || "").toLowerCase().includes(q.toLowerCase());
                const c = _c === 'All' || s.category === _c;
                return m && c;
            });
            f.sort((a, b) => {
                if ((a.featured || false) !== (b.featured || false)) return (b.featured ? 1 : 0) - (a.featured ? 1 : 0);
                return (b.votes || 0) - (a.votes || 0);
            });
            if (f.length === 0) {
                document.getElementById('emptyState').classList.remove('hidden');
            } else {
                document.getElementById('emptyState').classList.add('hidden');
                f.forEach(s => {
                    const i = (_u === _x_adm);
                    const v = s.votes || 0;
                    const mv = _v[s.id] || 0;
                    const ft = s.featured === true;
                    const u = mv === 1 ? 'text-orange-500' : 'text-gray-500 hover:text-orange-500';
                    const d = mv === -1 ? 'text-blue-500' : 'text-gray-500 hover:text-blue-500';
                    const fb = i 
                        ? `<button onclick="_0x1c9(${s.id})" class="${ft ? 'text-yellow-500 hover:text-yellow-400' : 'text-gray-600 hover:text-yellow-500'} p-1 transition"><i class="fas fa-star"></i></button>`
                        : (ft ? `<i class="fas fa-star text-yellow-500 p-1" title="Featured"></i>` : '');
                    const db = i ? `<button onclick="_0x5a2(${s.id})" class="text-red-900 hover:text-red-500 p-1 flex-shrink-0 transition"><i class="fas fa-trash"></i></button>` : '';
                    const c = document.createElement('div');
                    c.className = `ore-panel flex h-80 transition relative ${ft ? 'featured-gold' : ''}`;
                    c.innerHTML = `
                        <div class="w-12 border-r-2 border-[#1e1e1e] bg-[#222] flex flex-col items-center p-2 gap-1">
                            <button onclick="_0x4d2(${s.id}, 1)" class="${u} transition"><i class="fas fa-caret-up text-3xl"></i></button>
                            <span class="font-bold text-lg ${v > 0 ? 'text-orange-500' : (v < 0 ? 'text-blue-500' : 'text-gray-400')}">${v}</span>
                            <button onclick="_0x4d2(${s.id}, -1)" class="${d} transition"><i class="fas fa-caret-down text-3xl"></i></button>
                        </div>
                        <div class="flex-grow flex flex-col relative overflow-hidden">
                            <div class="p-3 border-b-2 border-[#1e1e1e] bg-[#333] flex justify-between items-start">
                                <div class="overflow-hidden w-full pr-2">
                                    <div class="flex items-center gap-2">
                                        <h3 class="font-bold text-white text-lg text-clamp-1" title="${_0x9e1(s.title)}">${_0x9e1(s.title)}</h3>
                                        ${ft ? '<span class="px-1.5 py-0.5 bg-yellow-900 text-yellow-200 text-[10px] font-bold uppercase rounded border border-yellow-600 flex-shrink-0">Featured</span>' : ''}
                                    </div>
                                    <div class="flex gap-2 mt-1 flex-wrap">
                                        <span class="text-xs bg-[#1e1e1e] px-2 py-0.5 text-blue-300 border border-[#3c3c3c] whitespace-nowrap">${_0x9e1(s.category)}</span>
                                        <span class="text-xs bg-[#1e1e1e] px-2 py-0.5 text-yellow-600 border border-[#3c3c3c] whitespace-nowrap">${_0x9e1(s.version)}</span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-1 flex-shrink-0">
                                    ${fb}
                                    ${db}
                                </div>
                            </div>
                            <div class="p-4 flex-grow bg-[#262626] overflow-hidden flex flex-col">
                                <p class="text-gray-400 text-sm text-clamp-2 mb-3 h-10">${_0x9e1(s.description || "No description provided.")}</p>
                                <div onclick="_0x8a4(${s.id})" class="code-preview-box group flex-grow relative">
                                    ${_0x9e1(s.code)}
                                    <div class="code-fade-overlay"></div>
                                    <div class="expand-overlay">
                                        <div class="flex items-center gap-2 text-white font-bold tracking-widest uppercase">
                                            <i class="fas fa-expand"></i> Expand
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="p-2 border-t-2 border-[#1e1e1e] bg-[#2b2b2b] flex justify-between items-center text-xs text-gray-500">
                                <span class="truncate">By <span class="text-gray-300">${_0x9e1(s.author)}</span></span>
                            </div>
                        </div>
                    `;
                    g.appendChild(c);
                });
            }
        }

        async function _0x4d2(i, t) {
            const x = _d.snippets.findIndex(s => s.id === i);
            if (x === -1) return;
            let c = _v[i] || 0;
            let f = 0;
            if (c === t) { f = -t; delete _v[i]; } 
            else if (c === 0) { f = t; _v[i] = t; } 
            else { f = -c + t; _v[i] = t; }
            localStorage.setItem('ls_user_votes', JSON.stringify(_v));
            if (!_d.snippets[x].votes) _d.snippets[x].votes = 0;
            _d.snippets[x].votes += f;
            _0x6b2(document.getElementById('searchInput').value);
            if (_x_mas) _0x4e3().catch(e => console.error(e));
        }

        async function _0x1c9(i) {
            const x = _d.snippets.findIndex(s => s.id === i);
            if (x === -1 || _u !== _x_adm) return;
            _d.snippets[x].featured = !_d.snippets[x].featured;
            _0x6b2(document.getElementById('searchInput').value);
            try { await _0x4e3(); } catch(e) { _0x3b2("Failed to save feature status.", "Error"); }
        }

        function _0x2f1() {
            const n1 = Math.floor(Math.random() * 10) + 1;
            const n2 = Math.floor(Math.random() * 10) + 1;
            _z = n1 + n2;
            document.getElementById('captchaLabel').innerText = `Security Check: What is ${n1} + ${n2}?`;
            document.getElementById('captchaInput').value = "";
        }

        async function _0x5c8() {
            const a = parseInt(document.getElementById('captchaInput').value);
            if (isNaN(a) || a !== _z) {
                _0x3b2("Incorrect Captcha Answer.", "Error");
                _0x2f1();
                return;
            }
            const t = document.getElementById('snipTitle').value;
            const ds = document.getElementById('snipDesc').value;
            const c = document.getElementById('snipCategory').value;
            const v = document.getElementById('snipVersion').value;
            const cd = document.getElementById('snipCode').value;
            if (!t || !cd) { _0x3b2("Title and Code are required!", "Validation Error"); return; }
            const sd = {
                id: Date.now(),
                title: t, 
                description: ds || "", 
                category: c, 
                version: v || "Unknown", 
                code: cd,
                votes: 0,
                featured: false,
                author: _u,
                date: new Date().toLocaleDateString()
            };
            const pl = {
                content: "<@858582768468099084> **New Snippet Pending Review**",
                embeds: [{
                    title: "Submission by " + _u,
                    description: "```json\n" + JSON.stringify(sd) + "\n```",
                    color: 3966247,
                    footer: { text: "Copy the JSON block above for admin import" }
                }]
            };
            try {
                await fetch(_x_dis, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(pl)
                });
                _0x3b2("Snippet submitted to Admin for review!", "Success");
                _0x4a7();
            } catch (err) {
                _0x3b2("Error connecting to Discord.", "Network Error");
            }
        }

        function _0x8a4(i) {
            const s = _d.snippets.find(k => k.id === i);
            if(!s) return;
            document.getElementById('viewTitle').textContent = s.title;
            document.getElementById('viewCategory').textContent = s.category;
            document.getElementById('viewVersion').textContent = s.version;
            document.getElementById('viewDesc').textContent = s.description || "No description provided.";
            document.getElementById('viewCode').value = s.code;
            document.getElementById('viewModal').classList.remove('hidden');
        }

        async function _0x7b6() {
            if (_u !== _x_adm) return;
            try {
                const r = document.getElementById('adminJsonPaste').value;
                const n = JSON.parse(r);
                if(!n.votes) n.votes = 0;
                n.featured = false;
                _d.snippets.unshift(n);
                await _0x4e3();
                _0x3b2("Published successfully!", "Admin");
                _0x9c4();
                _0x6b2();
            } catch (e) {
                _0x3b2("Invalid JSON or Save Failed.", "Error");
            }
        }

        function _0x5a2(i) {
            if (_u !== _x_adm) return;
            _0x8c1("Are you sure you want to delete this snippet permanently?", async () => {
                _d.snippets = _d.snippets.filter(s => s.id !== i);
                try {
                    await _0x4e3();
                    _0x6b2();
                } catch(e) { _0x3b2("Delete failed.", "Error"); }
            });
        }

        function _0x6f5() { 
            _0x2f1(); 
            document.getElementById('uploadModal').classList.remove('hidden'); 
        }
        function _0x4a7() { document.getElementById('uploadModal').classList.add('hidden'); }
        function _0x8d3() { document.getElementById('adminModal').classList.remove('hidden'); }
        function _0x9c4() { document.getElementById('adminModal').classList.add('hidden'); }
        function _0x1d9() { document.getElementById('viewModal').classList.add('hidden'); }
        function _0x7c4() { _0x6b2(document.getElementById('searchInput').value); }

        function _0x0f2(b) {
            const t = b.parentElement.querySelector('textarea');
            t.select();
            document.execCommand('copy');
            const o = b.innerHTML;
            b.innerHTML = '<i class="fas fa-check"></i> Copied!';
            b.classList.add('text-green-400');
            setTimeout(() => { b.innerHTML = o; b.classList.remove('text-green-400'); }, 2000);
        }

        function _0x9e1(u) { return (u || "").replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;"); }
    </script>
</body>
</html>
